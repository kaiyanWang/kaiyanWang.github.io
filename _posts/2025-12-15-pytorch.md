---
layout: article
title: 深度学习框架pytorch
tags: CS
cover: /assets/images/axure/page-single.jpg
---

[pytorch官方教程](https://docs.pytorch.org/tutorials/)

<!--more-->

`Conda`（Anaconda公司的包管理器）相比于`pip`（python官方的包管理器）的好处：
- Conda可以创建多个独立虚拟环境，避免版本冲突（pip本身没有环境管理功能，需要搭配venv使用，而Conda将环境管理和包管理集成在同一工具中，操作更加简洁）；
- pip只能管理Python包，无法处理深度学习框架依赖的非Python组件，如CUDA运行库，OpenCV的C++底层库，而Conda可以

`Pytorch`：深度学习框架

### 本地环境配置

第一步：安装Anaconda

第二步：创建虚拟环境
```bash
conda create -n py38 python=3.8  # 创建虚拟环境py38
conda activate py38  # 进入虚拟环境py38
```

第三步：搭建深度学习框架pytorch：查看是否有NVIDIA显卡，并到Pytorch官网下载对应的pytorch-cpu或pytorch-gpu版本
- 如果没有，安装pytorch-CPU版本
- 如果有，nvidia-smi查看显卡对应的CUDA版本，先安装CUDA和cuDNN，再安装pytorch-GPU版本（CUDA是NVIDIA推出的并行计算平台和API模型，它使得显卡可以用于通用并行计算等，cuDNN是CUDA的扩展库，专门针对深度神经网络中的基础操作提供高度优化的实现方式，如卷积、池化。如果不安装CUDA和cuDNN，pytorch-GPU将无法正常工作）

测试
```python
ipython
import torch
torch.cuda.is_available()  # 输出true
```

第四步：pycharm中使用存在的conda环境：anaconda/Scripts/conda.exe加载环境，选择py38；vscode中下载python和jupyter插件，选择py38环境

### 云服务器环境配置

创建虚拟环境
```bash
conda create -n py38 python=3.8  # 创建虚拟环境py38
conda activate py38  # 进入虚拟环境py38
```

安装想要的pytorch版本，[官方文档](https://pytorch.org/get-started/locally/)
```bash
conda install pytorch==1.13.1 torchvision==0.14.1 torchaudio==0.13.1 pytorch-cuda=11.6 -c pytorch -c nvidia
```

使用本地IDE远程调试
```bash
conda activate py38
which python  # 得到创建的虚拟环境的python解释器位置
```

### 常用的conda命令

虚拟环境管理
```bash
# 查看所有虚拟环境
conda env list  # 查看所有虚拟环境
conda create -n env_name python=3.10  # 创建虚拟环境env_name
conda activate env_name  # 激活虚拟环境env_name
conda env remove -n env_name  # 删除虚拟环境env_name
conda create -n new_env --clone old_env  # 基于old_env创建new_env
```

包管理
```bash
conda list  # 查看当前激活环境的包
conda install numpy=1.24  # 安装到当前环境
conda update numpy  # 更新指定包
conda update --all  # 更新当前环境所有包
conda update conda  # 更新conda自身
conda remove numpy  # 当前环境卸载
conda search tensorflow  # 搜索可用的tensorflow版本
```

配置与其他常用命令
```bash
conda --version  # 查看conda版本
conda env export > environment.yml  # 导出当前环境到yaml文件（分享/备份）
conda env create -f environment.yml  # 从yaml文件创建环境（一键复现）
```